title: "Finder Vim Controls & Other Commands"
homepage: https://github.com/chrisgrieser/dotfiles/karabiner
rules:
  - description: "Finder Basic Control"
    manipulators:
      # Sidebar
      - type: basic
        from:
          key_code: "1"
          modifiers:
            mandatory:
              - command
        to:
          - key_code: s
            modifiers:
              - command
              - option
        conditions:
          - type: frontmost_application_if
            bundle_identifiers:
              - ^com\.apple\.finder$
      # copy path
      - type: basic
        from:
          key_code: p
          modifiers:
            mandatory:
              - control
        to:
          - key_code: c
            modifiers:
              - command
              - option
        conditions:
          - type: frontmost_application_if
            bundle_identifiers:
              - ^com\.apple\.finder$
      # pseudo-quick-switcher
      - type: basic
        from:
          key_code: o
          modifiers:
            mandatory:
              - command
        to:
          - key_code: g
            modifiers:
              - command
              - shift
        conditions:
          - type: frontmost_application_if
            bundle_identifiers:
              - ^com\.apple\.finder$
      # Cut & Paste Workaround
      - type: basic
        from:
          key_code: x
          modifiers:
            mandatory:
              - command
        to:
          - key_code: c
            modifiers:
              - command
          - set_variable:
              name: CUT_ACTIVE
              value: true
          - set_notification_message:
              id: cut-notice
              text: "✂️ Cut"
        conditions:
          - type: frontmost_application_if
            bundle_identifiers:
              - ^com\.apple\.finder$
      - type: basic
        from:
          key_code: v
          modifiers:
            mandatory:
              - command
        conditions:
          - type: variable_if
            name: CUT_ACTIVE
            value: true
          - type: frontmost_application_if
            bundle_identifiers:
              - ^com\.apple\.finder$
        to:
          - key_code: v
            modifiers:
              - command
              - option
          - set_variable:
              name: CUT_ACTIVE
              value: false
          - set_notification_message:
              id: cut-notice
              text: ""
      # Abort with Hyper/Esc
      - type: basic
        from:
          key_code: caps_lock
        conditions:
          - type: variable_if
            name: CUT_ACTIVE
            value: true
          - type: frontmost_application_if
            bundle_identifiers:
              - ^com\.apple\.finder$
        to:
          - set_variable:
              name: CUT_ACTIVE
              value: false
          - set_notification_message:
              id: cut-notice
              text: ""
      - type: basic
        from:
          key_code: escape
        conditions:
          - type: variable_if
            name: CUT_ACTIVE
            value: true
          - type: frontmost_application_if
            bundle_identifiers:
              - ^com\.apple\.finder$
        to:
          - set_variable:
              name: CUT_ACTIVE
              value: false
          - set_notification_message:
              id: cut-notice
              text: ""
      # Abort when deciding to copy instead
      - type: basic
        from:
          key_code: c
          modifiers:
            mandatory:
              - command
        conditions:
          - type: variable_if
            name: CUT_ACTIVE
            value: true
          - type: frontmost_application_if
            bundle_identifiers:
              - ^com\.apple\.finder$
        to:
          - key_code: c
            modifiers:
              - command
          - set_variable:
              name: CUT_ACTIVE
              value: false
          - set_notification_message:
              id: cut-notice
              text: ""
      # hyper + ⌫ = Open Trash
      - type: basic
        from:
          key_code: delete_or_backspace
          modifiers:
            mandatory:
              - command
              - shift
              - option
              - control
        to:
          - shell_command: open -a "Finder" ~/.Trash
          - key_code: vk_none
            hold_down_milliseconds: 200
          - key_code: "2" # list view
            modifiers:
              - command
